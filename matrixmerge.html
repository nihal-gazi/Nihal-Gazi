<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Matrix Merger</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- ExcelJS for Reading/Writing with Styles -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
    
    <!-- FileSaver.js for saving files -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* Mobile optimizations */
        body { font-family: 'Inter', sans-serif; }
        input[type="number"], input[type="text"] {
            font-size: 16px; /* Prevents iOS zoom on focus */
        }
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0,0,0,0.1);
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 min-h-screen pb-20">

    <!-- Header -->
    <header class="bg-blue-600 text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="max-w-md mx-auto flex items-center gap-2">
            <i data-lucide="grid-3x3" class="w-6 h-6"></i>
            <h1 class="text-lg font-bold">Matrix Merger</h1>
        </div>
    </header>

    <main class="max-w-md mx-auto p-4 space-y-6">

        <!-- Mode Selector -->
        <div class="flex bg-slate-200 p-1 rounded-xl">
            <button id="modeMatrixBtn" class="flex-1 text-sm font-bold py-2 px-3 rounded-lg bg-white text-blue-600 shadow transition-all">
                Matrix Merger (2 Files)
            </button>
            <button id="modeSingleBtn" class="flex-1 text-sm font-bold py-2 px-3 rounded-lg text-slate-600 transition-all">
                Single Column (1 File)
            </button>
        </div>

        <!-- Step 1: File Inputs -->
        <section class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
            <h2 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">1</span>
                Upload Files
            </h2>
            
            <!-- Matrix File Inputs -->
            <div id="fileInputsMatrix" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-1 text-slate-700">File 1 (Data X)</label>
                    <input type="file" id="file1" accept=".xlsx, .xls" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1 text-slate-700">File 2 (Data Y)</label>
                    <input type="file" id="file2" accept=".xlsx, .xls" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100"/>
                </div>
            </div>

            <!-- Single File Input (Hidden) -->
            <div id="fileInputsSingle" class="space-y-4 hidden">
                <div>
                    <label class="block text-sm font-medium mb-1 text-slate-700">Excel File</label>
                    <input type="file" id="fileSingle" accept=".xlsx, .xls" class="block w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"/>
                </div>
            </div>
        </section>

        <!-- Step 2: Configuration -->
        <section class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
            <h2 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">2</span>
                Configuration
            </h2>

            <!-- Matrix Col Inputs -->
            <div id="colInputsMatrix" class="grid grid-cols-2 gap-4 mb-4">
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Col Index X (File 1, A=1)</label>
                    <input type="number" id="colIndex1" value="1" min="1" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Col Index Y (File 2, A=1)</label>
                    <input type="number" id="colIndex2" value="1" min="1" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
            </div>

            <!-- Single Col Input (Hidden) -->
            <div id="colInputsSingle" class="grid grid-cols-2 gap-4 mb-4 hidden">
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Col Index (A=1)</label>
                    <input type="number" id="colIndexSingle" value="1" min="1" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Split Row Index (1,2,3...)</label>
                    <input type="number" id="splitRowIndex" value="10" min="2" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
            </div>

            <!-- Common Inputs -->
            <div class="space-y-3 mb-4">
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Top Header Text</label>
                    <input type="text" id="headerText1" placeholder="e.g. Project Alpha" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Sub Header Text</label>
                    <input type="text" id="headerText2" placeholder="e.g. Q3 Report" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4">
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Rows (M)</label>
                    <input type="number" id="rowsM" value="10" min="1" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
                <div>
                    <label class="block text-xs font-medium text-slate-500 mb-1">Columns (N)</label>
                    <input type="number" id="colsN" value="3" min="1" class="w-full p-2 border rounded-lg bg-slate-50 focus:ring-2 focus:ring-blue-500 outline-none">
                </div>
            </div>
        </section>

        <!-- Step 3: Styling -->
        <section class="bg-white p-5 rounded-2xl shadow-sm border border-slate-200">
            <h2 class="text-sm font-bold text-slate-400 uppercase tracking-wider mb-4 flex items-center gap-2">
                <span class="bg-blue-100 text-blue-600 w-6 h-6 rounded-full flex items-center justify-center text-xs">3</span>
                Styling
            </h2>

            <div class="space-y-4">
                <!-- Header 1 Style -->
                <div class="p-3 bg-slate-50 rounded-lg border border-slate-100">
                    <p class="text-xs font-bold text-slate-600 mb-2">Header 1 Styling</p>
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <label class="text-[10px] text-slate-400">Font Color</label>
                            <div class="flex items-center gap-2 h-8">
                                <input type="color" id="h1Color" value="#ffffff" class="w-8 h-8 rounded cursor-pointer border-0 p-0">
                            </div>
                        </div>
                        <div class="flex-1">
                            <label class="text-[10px] text-slate-400">Size</label>
                            <input type="number" id="h1Size" value="16" class="w-full h-8 px-2 text-sm border rounded">
                        </div>
                    </div>
                </div>

                <!-- Header 2 Style -->
                <div class="p-3 bg-slate-50 rounded-lg border border-slate-100">
                    <p class="text-xs font-bold text-slate-600 mb-2">Header 2 Styling</p>
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <label class="text-[10px] text-slate-400">Font Color</label>
                            <div class="flex items-center gap-2 h-8">
                                <input type="color" id="h2Color" value="#ffffff" class="w-8 h-8 rounded cursor-pointer border-0 p-0">
                            </div>
                        </div>
                        <div class="flex-1">
                            <label class="text-[10px] text-slate-400">Size</label>
                            <input type="number" id="h2Size" value="14" class="w-full h-8 px-2 text-sm border rounded">
                        </div>
                    </div>
                </div>

                <!-- X Data Style -->
                <div class="p-3 bg-blue-50 rounded-lg border border-blue-100">
                    <p class="text-xs font-bold text-blue-600 mb-2">File 1 (X) Data Styling</p>
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <label class="text-[10px] text-blue-400">Font Color</label>
                            <div class="flex items-center gap-2 h-8">
                                <input type="color" id="xColor" value="#000000" class="w-8 h-8 rounded cursor-pointer border-0 p-0">
                            </div>
                        </div>
                        <div class="flex-1">
                            <label class="text-[10px] text-blue-400">Size</label>
                            <input type="number" id="xSize" value="11" class="w-full h-8 px-2 text-sm border rounded">
                        </div>
                    </div>
                </div>

                <!-- Y Data Style -->
                <div class="p-3 bg-green-50 rounded-lg border border-green-100">
                    <p class="text-xs font-bold text-green-600 mb-2">File 2 (Y) Data Styling</p>
                    <div class="flex gap-3">
                        <div class="flex-1">
                            <label class="text-[10px] text-green-400">Font Color</label>
                            <div class="flex items-center gap-2 h-8">
                                <input type="color" id="yColor" value="#000000" class="w-8 h-8 rounded cursor-pointer border-0 p-0">
                            </div>
                        </div>
                        <div class="flex-1">
                            <label class="text-[10px] text-green-400">Size</label>
                            <input type="number" id="ySize" value="11" class="w-full h-8 px-2 text-sm border rounded">
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Action -->
        <div class="space-y-3">
            <button id="previewBtn" class="w-full bg-slate-100 text-slate-700 font-bold py-3 rounded-xl border border-slate-300 active:scale-95 transition-transform flex items-center justify-center gap-2">
                <i data-lucide="eye" class="w-5 h-5"></i>
                Update Preview
            </button>
            <button id="generateBtn" class="w-full bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-bold py-4 rounded-xl shadow-lg active:scale-95 transition-transform flex items-center justify-center gap-2">
                <i data-lucide="download" class="w-5 h-5"></i>
                Generate Excel
            </button>
        </div>

        <div id="status" class="hidden text-center text-sm p-2 rounded bg-slate-200 text-slate-700 animate-pulse">
            Processing...
        </div>

        <!-- Preview Area -->
        <div id="previewArea" class="mt-4 bg-white p-4 rounded-2xl shadow-sm border border-slate-200 overflow-x-auto">
            <p class="text-sm text-slate-400 text-center">Click "Update Preview" to see your matrix here.</p>
        </div>

    </main>

    <script>
        // Initialize Icons
        lucide.createIcons();

        let activeMode = 'matrix'; // 'matrix' or 'single'

        // --- NEW: Mode Toggles ---
        const modeMatrixBtn = document.getElementById('modeMatrixBtn');
        const modeSingleBtn = document.getElementById('modeSingleBtn');
        
        const fileInputsMatrix = document.getElementById('fileInputsMatrix');
        const fileInputsSingle = document.getElementById('fileInputsSingle');
        const colInputsMatrix = document.getElementById('colInputsMatrix');
        const colInputsSingle = document.getElementById('colInputsSingle');

        modeMatrixBtn.addEventListener('click', () => {
            activeMode = 'matrix';
            modeMatrixBtn.classList.add('bg-white', 'text-blue-600', 'shadow');
            modeSingleBtn.classList.remove('bg-white', 'text-blue-600', 'shadow');
            modeSingleBtn.classList.add('text-slate-600');
            
            fileInputsMatrix.classList.remove('hidden');
            colInputsMatrix.classList.remove('hidden');
            fileInputsSingle.classList.add('hidden');
            colInputsSingle.classList.add('hidden');
        });

        modeSingleBtn.addEventListener('click', () => {
            activeMode = 'single';
            modeSingleBtn.classList.add('bg-white', 'text-blue-600', 'shadow');
            modeMatrixBtn.classList.remove('bg-white', 'text-blue-600', 'shadow');
            modeMatrixBtn.classList.add('text-slate-600');

            fileInputsSingle.classList.remove('hidden');
            colInputsSingle.classList.remove('hidden');
            fileInputsMatrix.classList.add('hidden');
            colInputsMatrix.classList.add('hidden');
        });
        // --- End Mode Toggles ---


        async function readColumnFromExcel(file, colIndex) {
            const workbook = new ExcelJS.Workbook();
            const arrayBuffer = await file.arrayBuffer();
            await workbook.xlsx.load(arrayBuffer);
            
            const worksheet = workbook.worksheets[0]; // Read first sheet
            const data = [];
            
            worksheet.eachRow((row, rowNumber) => {
                // colIndex is 0-based, getCell is 1-based
                const cell = row.getCell(parseInt(colIndex) + 1);
                const val = cell.value;
                // Push empty string for null/undefined to keep row indices correct
                data.push(val ? val.toString() : "");
            });
            return data;
        }

        const generateBtn = document.getElementById('generateBtn');
        const previewBtn = document.getElementById('previewBtn');

        generateBtn.addEventListener('click', () => runGenerationLogic('excel'));
        previewBtn.addEventListener('click', () => runGenerationLogic('preview'));

        async function runGenerationLogic(outputType = 'excel') {
            const statusEl = document.getElementById('status');
            
            let dataX, dataY; // Declare data arrays
            
            try {
                statusEl.textContent = "Reading files...";
                statusEl.classList.remove('hidden');
                generateBtn.disabled = true;
                previewBtn.disabled = true;
                generateBtn.classList.add('opacity-75');
                previewBtn.classList.add('opacity-75');

                // --- Mode-based data loading ---
                if (activeMode === 'matrix') {
                    const file1Input = document.getElementById('file1');
                    const file2Input = document.getElementById('file2');

                    if (!file1Input.files[0] || !file2Input.files[0]) {
                        // MODIFIED: Use custom alert modal
                        showModal("Please select both Excel files for Matrix Mode.");
                        statusEl.classList.add('hidden');
                        generateBtn.disabled = false;
                        previewBtn.disabled = false;
                        generateBtn.classList.remove('opacity-75');
                        previewBtn.classList.remove('opacity-75');
                        return;
                    }
                    
                    // 1. Read Data
                    const colX = parseInt(document.getElementById('colIndex1').value) - 1;
                    const colY = parseInt(document.getElementById('colIndex2').value) - 1;
                    
                    dataX = await readColumnFromExcel(file1Input.files[0], colX);
                    dataY = await readColumnFromExcel(file2Input.files[0], colY);
                
                } else { // activeMode === 'single'
                    const fileSingleInput = document.getElementById('fileSingle');
                    
                    if (!fileSingleInput.files[0]) {
                        // MODIFIED: Use custom alert modal
                        showModal("Please select an Excel file for Single Column Mode.");
                        statusEl.classList.add('hidden');
                        generateBtn.disabled = false;
                        previewBtn.disabled = false;
                        generateBtn.classList.remove('opacity-75');
                        previewBtn.classList.remove('opacity-75');
                        return;
                    }

                    const colX = parseInt(document.getElementById('colIndexSingle').value) - 1;
                    // User's 1-based "split row" index.
                    // e.g., 10. This means file row 10 is the last X.
                    // allData[0] is file row 1 (header)
                    // allData[9] is file row 10 (last X)
                    // allData[10] is file row 11 (first Y)
                    const splitIndex = parseInt(document.getElementById('splitRowIndex').value); 
                    
                    const allData = await readColumnFromExcel(fileSingleInput.files[0], colX);
                    
                    // X data is from row 2 (index 1) up to row `splitIndex` (index `splitIndex - 1`)
                    // slice(start, end) is exclusive of end.
                    // slice(1, splitIndex) gives indices 1... (splitIndex - 1)
                    dataX = allData.slice(1, splitIndex); 
                    
                    // Y data starts from *after* the split index, so row `splitIndex + 1` (index `splitIndex`)
                    dataY = allData.slice(splitIndex);
                }
                // --- End data loading ---


                // 2. Setup Workbook for Output
                const wb = new ExcelJS.Workbook();
                const ws = wb.addWorksheet('Matrix Result');

                // 3. Inputs
                const rowsM = parseInt(document.getElementById('rowsM').value);
                const colsN = parseInt(document.getElementById('colsN').value);
                const head1Txt = document.getElementById('headerText1').value;
                const head2Txt = document.getElementById('headerText2').value;

                // Styles
                const h1ColorHex = document.getElementById('h1Color').value;
                const h2ColorHex = document.getElementById('h2Color').value;
                const xColorHex = document.getElementById('xColor').value;
                const yColorHex = document.getElementById('yColor').value;

                const styles = {
                    h1: { 
                        color: { argb: h1ColorHex.replace('#', 'FF') },
                        size: parseInt(document.getElementById('h1Size').value),
                        bg: { argb: 'FF4F46E5' }, // Indigo background for header
                        colorHex: h1ColorHex,
                        bgHex: '#4F46E5'
                    },
                    h2: { 
                        color: { argb: h2ColorHex.replace('#', 'FF') },
                        size: parseInt(document.getElementById('h2Size').value),
                        bg: { argb: 'FF6366F1' }, // Lighter indigo
                        colorHex: h2ColorHex,
                        bgHex: '#6366F1'
                    },
                    x: { 
                        color: { argb: xColorHex.replace('#', 'FF') },
                        size: parseInt(document.getElementById('xSize').value),
                        colorHex: xColorHex
                    },
                    y: { 
                        color: { argb: yColorHex.replace('#', 'FF') },
                        size: parseInt(document.getElementById('ySize').value),
                        colorHex: yColorHex
                    }
                };

                // 4. Write Headers (Row 1 and Row 2) - ExcelJS
                ws.mergeCells(1, 1, 1, colsN);
                const cellH1 = ws.getCell(1, 1);
                cellH1.value = head1Txt;
                cellH1.font = { color: styles.h1.color, size: styles.h1.size, bold: true };
                cellH1.fill = { type: 'pattern', pattern: 'solid', fgColor: styles.h1.bg };
                cellH1.alignment = { horizontal: 'center' };

                ws.mergeCells(2, 1, 2, colsN);
                const cellH2 = ws.getCell(2, 1);
                cellH2.value = head2Txt;
                cellH2.font = { color: styles.h2.color, size: styles.h2.size, bold: true };
                cellH2.fill = { type: 'pattern', pattern: 'solid', fgColor: styles.h2.bg };
                cellH2.alignment = { horizontal: 'center' };

                // 5. Construct Matrix (Checkerboard Logic)
                
                let ptrX = (activeMode === 'matrix') ? 1 : 0;
                let ptrY = (activeMode === 'matrix') ? 1 : 0;
                const startRow = 3; 

                // Create a 2D array to hold data for preview (which is row-major)
                let previewGrid = Array(rowsM).fill(null).map(() => Array(colsN).fill(null));

                for (let c = 0; c < colsN; c++) {
                    for (let r = 0; r < rowsM; r++) {
                        const cell = ws.getCell(startRow + r, c + 1);
                        const isTypeX = (r + c) % 2 === 0;
                        let val, styleKey;

                        if (isTypeX) {
                            // Data X
                            val = ptrX < dataX.length ? dataX[ptrX] : "";
                            styleKey = 'x';
                            ptrX++;
                        } else {
                            // Data Y
                            val = ptrY < dataY.length ? dataY[ptrY] : "";
                            styleKey = 'y';
                            ptrY++;
                        }
                        
                        // Populate Excel Cell
                        cell.value = val;
                        cell.font = { color: styles[styleKey].color, size: styles[styleKey].size };
                        cell.fill = { type: 'pattern', pattern: 'solid', fgColor: (styleKey === 'x' ? { argb: 'FFF8FAFC' } : { argb: 'FFF0FDF4' }) };
                        cell.border = {
                            top: {style:'thin'},
                            left: {style:'thin'},
                            bottom: {style:'thin'},
                            right: {style:'thin'}
                        };

                        // Populate Preview Grid
                        previewGrid[r][c] = { value: val, styleKey: styleKey };
                    }
                }

                // 6. Output based on type
                if (outputType === 'preview') {
                    statusEl.textContent = "Generating preview...";
                    let previewHtml = '<table class="w-full border-collapse border border-slate-300 text-sm text-center">';
                    // Headers
                    previewHtml += `<thead><tr><th colspan="${colsN}" style="background-color: ${styles.h1.bgHex}; color: ${styles.h1.colorHex}; font-size: ${styles.h1.size}px; padding: 4px; border: 1px solid #999;">${head1Txt}</th></tr>`;
                    previewHtml += `<tr><th colspan="${colsN}" style="background-color: ${styles.h2.bgHex}; color: ${styles.h2.colorHex}; font-size: ${styles.h2.size}px; padding: 4px; border: 1px solid #999;">${head2Txt}</th></tr></thead>`;
                    previewHtml += '<tbody>';

                    // Body (from row-major grid)
                    for (let r = 0; r < rowsM; r++) {
                        previewHtml += '<tr>';
                        for (let c = 0; c < colsN; c++) {
                            const item = previewGrid[r][c];
                            if (item) {
                                const style = styles[item.styleKey];
                                const bgColor = item.styleKey === 'x' ? '#F8FAFC' : '#F0FDF4';
                                previewHtml += `<td style="color: ${style.colorHex}; font-size: ${style.size}px; background-color: ${bgColor}; border: 1px solid #cbd5e1; padding: 2px 4px; white-space: nowrap;">${item.value}</td>`;
                            } else {
                                previewHtml += '<td style="border: 1px solid #cbd5e1; padding: 2px 4px;"></td>';
                            }
                        }
                        previewHtml += '</tr>';
                    }
                    previewHtml += '</tbody></table>';

                    document.getElementById('previewArea').innerHTML = previewHtml;

                    statusEl.textContent = "Preview updated!";
                    setTimeout(() => {
                        statusEl.classList.add('hidden');
                        generateBtn.disabled = false;
                        previewBtn.disabled = false;
                        generateBtn.classList.remove('opacity-75');
                        previewBtn.classList.remove('opacity-75');
                    }, 2000);

                } else { // outputType === 'excel'
                    // 6. Save File
                    statusEl.textContent = "Generating file...";
                    const buffer = await wb.xlsx.writeBuffer();
                    const blob = new Blob([buffer], { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });
                    saveAs(blob, "matrix_output.xlsx");

                    statusEl.textContent = "Done!";
                    setTimeout(() => {
                        statusEl.classList.add('hidden');
                        generateBtn.disabled = false;
                        previewBtn.disabled = false;
                        generateBtn.classList.remove('opacity-75');
                        previewBtn.classList.remove('opacity-75');
                    }, 2000);
                }

            } catch (err) {
                console.error(err);
                // MODIFIED: Use custom alert modal
                showModal("Error processing files. Check console for details.");
                statusEl.textContent = "Error";
                generateBtn.disabled = false;
                previewBtn.disabled = false;
                generateBtn.classList.remove('opacity-75');
                previewBtn.classList.remove('opacity-75');
            }
        }

        // --- Custom Alert Modal ---
        // Create modal elements once
        const modalBg = document.createElement('div');
        modalBg.className = "fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4 hidden";
        
        const modalBox = document.createElement('div');
        modalBox.className = "bg-white rounded-lg shadow-xl p-6 max-w-sm w-full";
        
        const modalTitle = document.createElement('h3');
        modalTitle.className = "text-lg font-bold text-slate-800 mb-2";
        modalTitle.innerText = "Notice";

        const modalMessage = document.createElement('p');
        modalMessage.className = "text-sm text-slate-600 mb-4";
        
        const modalCloseBtn = document.createElement('button');
        modalCloseBtn.className = "w-full bg-blue-600 text-white font-bold py-2 px-4 rounded-lg";
        modalCloseBtn.innerText = "OK";
        
        modalBox.append(modalTitle, modalMessage, modalCloseBtn);
        modalBg.append(modalBox);
        document.body.append(modalBg);

        modalCloseBtn.addEventListener('click', () => {
            modalBg.classList.add('hidden');
        });

        function showModal(message) {
            modalMessage.innerText = message;
            modalBg.classList.remove('hidden');
        }

        // Replace native alert
        // This is a simple override. For a production app, this is not recommended,
        // but for this tool it prevents the iframe issue.
        window.alert = showModal;

    </script>
</body>
</html>